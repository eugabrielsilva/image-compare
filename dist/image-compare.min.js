document.querySelectorAll(".image-compare").forEach(el=>{el.querySelectorAll("img").forEach(elem=>{let div=document.createElement("div");div.classList.add("image-compare-wrapper"),elem.classList.add("image-compare-image"),elem.parentElement.insertBefore(div,elem),div.appendChild(elem)}),el.beforeImg=el.querySelector("div:first-of-type"),el.afterImg=el.querySelector("div:last-of-type"),el.isDragging=!1,el.zoomProp=document.querySelector("body").style.zoom,el.zoomProp&&"unset"!==el.zoomProp||(el.zoomProp=1),el.beforeImg.querySelector("img").style.width=el.clientWidth+"px",el.handle=document.createElement("a"),el.handle.className="image-compare-handle",el.appendChild(el.handle),el.beforeLabel=document.createElement("span"),el.afterLabel=document.createElement("span"),el.beforeLabel.classList.add("image-compare-label"),el.afterLabel.classList.add("image-compare-label"),el.beforeLabel.innerHTML=el.getAttribute("data-before-label")||"Before",el.afterLabel.innerHTML=el.getAttribute("data-after-label")||"After",el.beforeImg.appendChild(el.beforeLabel),el.afterImg.appendChild(el.afterLabel),el.handle.addEventListener("mousedown",()=>{el.isDragging=!0}),el.addEventListener("mousemove",e=>{if(el.isDragging){let rect=el.getBoundingClientRect(),x=e.clientX-rect.left*el.zoomProp;x/=el.zoomProp,x>=0&&x<=el.clientWidth&&(el.handle.style.left=x+"px",el.beforeImg.style.width=x+"px")}}),el.addEventListener("touchmove",e=>{if(e.changedTouches[0]){let rect=el.getBoundingClientRect(),x=e.changedTouches[0].clientX-rect.left*el.zoomProp;x/=el.zoomProp,x>=0&&x<=el.clientWidth&&(el.handle.style.left=x+"px",el.beforeImg.style.width=x+"px")}}),window.addEventListener("mouseup",()=>{el.isDragging=!1}),window.addEventListener("resize",()=>{el.zoomProp=document.querySelector("body").style.zoom,el.zoomProp&&"unset"!==el.zoomProp||(el.zoomProp=1),el.beforeImg.querySelector("img").style.width=el.clientWidth+"px",el.handle.style.left="50%",el.beforeImg.style.width="50%"})});